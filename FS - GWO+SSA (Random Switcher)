{"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"EJtX5aaVFKgS"},"outputs":[],"source":["import numpy as np\n","import pandas as pd\n","from sklearn.neighbors import KNeighborsClassifier\n","from sklearn.model_selection import KFold\n","from numpy.random import rand\n","from sklearn.neighbors import KNeighborsClassifier\n","import matplotlib.pyplot as plt\n","import time"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"gbX696WXAslG"},"outputs":[],"source":["def error_rate(features, target, x, opts):\n","    # parameters\n","    k     = opts['k']\n","    cv    = opts['cv']\n","\n","    kf = KFold(n_splits=cv, shuffle=True, random_state=2)\n","\n","    total_error = 0\n","\n","    for train_index, test_index in kf.split(features):\n","      X_train, X_test = features[train_index], features[test_index]\n","      y_train, y_test = target[train_index], target[test_index]\n","\n","      # Number of instances\n","      num_train = np.size(X_train, 0)\n","      num_test  = np.size(X_test, 0)\n","      \n","      # Define selected features\n","      xtrain = X_train[:, x==1]\n","      ytrain = y_train.reshape(num_train)\n","      xtest  = X_test[:, x==1]\n","      ytest  = y_test.reshape(num_test)\n","\n","      # Training\n","      knn = KNeighborsClassifier(n_neighbors=k)\n","      knn.fit(xtrain, ytrain)\n","\n","      # Prediction\n","      ypred = knn.predict(xtest)\n","      acc   = np.sum(ytest == ypred) / num_test\n","      error = 1 - acc\n","\n","      total_error = total_error + error\n","      \n","    return total_error/cv"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"36YgnDeM_mTW"},"outputs":[],"source":["def Fun(features, target, x, opts):\n","    # Parameters\n","    alpha    = 0.99\n","    beta     = 1 - alpha\n","    # Original feature size\n","    max_feat = len(x)\n","    # Number of selected features\n","    num_feat = np.sum(x == 1)\n","    # Solve if no feature selected\n","    if num_feat == 0:\n","        cost  = 1\n","    else:\n","        # Get error rate\n","        error = error_rate(features, target, x, opts)\n","        # Objective function\n","        cost  = alpha * error + beta * (num_feat / max_feat)\n","        \n","    return cost"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"UIIs5LfF_zD9"},"outputs":[],"source":["def init_position(lb, ub, N, dim):\n","    X = np.zeros([N, dim], dtype='float')\n","    R = rand()\n","    u = 1 + R\n","    for d in range(dim):\n","        X[0,d] = lb[0,d] + (ub[0,d] - lb[0,d]) * rand()\n","    for i in range(1, N):\n","        for d in range(dim):\n","            if X[i-1,d] \u003c= 0.5:\n","                X[i,d] = u * X[i-1,d]\n","            else:\n","                X[i,d] = u * (1 - X[i-1,d])\n","    \n","    return X"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"Q2GwviAx_6cG"},"outputs":[],"source":["def binary_conversion(X, thres, N, dim):\n","    Xbin = np.zeros([N, dim], dtype='int')\n","    for i in range(N):\n","        for d in range(dim):\n","            # xi = 1/(1 + np.exp(-X[i,d]))\n","            # if xi \u003e rand():\n","            if X[i,d] \u003e 0.5:\n","                Xbin[i,d] = 0\n","            else:\n","                Xbin[i,d] = 1\n","    \n","    return Xbin"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"D1GVeQ3j_-Ue"},"outputs":[],"source":["def boundary(x, lb, ub):\n","    if x \u003c lb:\n","        x = lb\n","    if x \u003e ub:\n","        x = ub\n","    \n","    return x"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"KcfLyiqKADkB"},"outputs":[],"source":["def gwo_ssa_random(features, target, opts):\n","    # Parameters\n","    ub    = 1\n","    lb    = 0\n","    thres = rand()    # NEED TO CHANGE\n","\n","    C1 = 2\n","    C2 = 2\n","\n","    N        = opts['N']\n","    max_iter = opts['T']\n","    if 'w' in opts:\n","        w    = opts['w']\n","    if 'c1' in opts:\n","        c1   = opts['c1']\n","    if 'c2' in opts:\n","        c2   = opts['c2'] \n","    \n","    # Dimension\n","    dim = np.size(features, 1)\n","    if np.size(lb) == 1:\n","        ub = ub * np.ones([1, dim], dtype='float')\n","        lb = lb * np.ones([1, dim], dtype='float')\n","        \n","    # Initialize position\n","    X     = init_position(lb, ub, N, dim)\n","\n","    # Binary conversion\n","    Xbin  = binary_conversion(X, thres, N, dim)\n","\n","    # Fitness at first iteration\n","    fit    = np.zeros([N, 1], dtype='float')\n","    Xalpha = np.zeros([1, dim], dtype='float')\n","    Xbeta  = np.zeros([1, dim], dtype='float')\n","    Xdelta = np.zeros([1, dim], dtype='float')\n","    Falpha = float('inf')\n","    Fbeta  = float('inf')\n","    Fdelta = float('inf')\n","\n","    #################################################\n","    ########## GWO ##################################\n","    #################################################\n","\n","    for i in range(N):\n","      fit[i,0] = Fun(features, target, Xbin[i,:], opts)\n","      if fit[i,0] \u003c Falpha:\n","        Xalpha[0,:] = X[i,:]\n","        Falpha      = fit[i,0]\n","\n","      if fit[i,0] \u003c Fbeta and fit[i,0] \u003e Falpha:\n","        Xbeta[0,:]  = X[i,:]\n","        beta       = fit[i,0]\n","            \n","      if fit[i,0] \u003c Fdelta and fit[i,0] \u003e Fbeta and fit[i,0] \u003e Falpha:\n","        Xdelta[0,:] = X[i,:]\n","        Fdelta      = fit[i,0]\n","\n","    # Pre\n","    curve = np.zeros([1, max_iter], dtype='float')\n","    t     = 0\n","\n","    curve[0,t] = Falpha.copy()\n","    print(\"Iteration:\", t + 1)\n","    print(\"Best (GWO):\", curve[0,t])\n","    t += 1\n","    \n","    while t \u003c max_iter:\n","        randomSwitcher = rand()\n","\n","        if randomSwitcher \u003c 0.5:\n","            # Coefficient decreases linearly from 2 to 0 \n","            a = 2 - t * (2 / max_iter)\n","            \n","            for i in range(N):\n","                for d in range(dim):\n","                    # Random values\n","                    r1     = rand()\n","                    r2     = rand()\n","                    # Parameter C (3.4)\n","                    C1     = 2 * rand()\n","                    C2     = 2 * rand()\n","                    C3     = 2 * rand()\n","                    # Compute Dalpha, Dbeta \u0026 Ddelta (3.5)\n","                    Dalpha = abs(C1 * Xalpha[0,d] - X[i,d]) \n","                    Dbeta  = abs(C2 * Xbeta[0,d] - X[i,d])\n","                    Ddelta = abs(C3 * Xdelta[0,d] - X[i,d])\n","                    # Parameter A (3.3)\n","                    A1     = 2 * a * rand() - a\n","                    A2     = 2 * a * rand() - a\n","                    A3     = 2 * a * rand() - a\n","                    # Compute X1, X2 \u0026 X3 (3.6) \n","                    X1     = Xalpha[0,d] - A1 * Dalpha\n","                    X2     = Xbeta[0,d] - A2 * Dbeta\n","                    X3     = Xdelta[0,d] - A3 * Ddelta\n","                    # Update wolf (3.7)\n","                    X[i,d] = (X1 + X2 + X3) / 3                \n","                    # Boundary\n","                    X[i,d] = boundary(X[i,d], lb[0,d], ub[0,d])\n","\n","        else:\n","\n","            c1 = 2 * np.exp(-(4 * t / max_iter) ** 2)\n","            \n","            for i in range(N):          \n","                # First leader update\n","                if i == 0:  \n","                    for d in range(dim):\n","                        # Coefficient c2 \u0026 c3 [0 ~ 1]\n","                        c2 = rand() \n","                        c3 = rand()\n","                        # Leader update (3.1)\n","                        if c3 \u003e= 0.5: \n","                            X[i,d] = Xalpha[0,d] + c1 * ((ub[0,d] - lb[0,d]) * c2 + lb[0,d])\n","                        else:\n","                            X[i,d] = Xalpha[0,d] - c1 * ((ub[0,d] - lb[0,d]) * c2 + lb[0,d])\n","                    \n","                        # Boundary\n","                        X[i,d] = boundary(X[i,d], lb[0,d], ub[0,d]) \n","                    \n","                # Salp update\n","                elif i \u003e= 1:\n","                    for d in range(dim):\n","                        # Salp update by following front salp (3.4)\n","                        X[i,d] = (X[i,d] + X[i-1, d]) / 2\n","                        # Boundary\n","                        X[i,d] = boundary(X[i,d], lb[0,d], ub[0,d])\n","\n","        # Binary conversion\n","        Xbin  = binary_conversion(X, thres, N, dim)\n","        \n","        # Fitness\n","        for i in range(N):\n","            fit[i,0] = Fun(features, target, Xbin[i,:], opts)\n","            if fit[i,0] \u003c Falpha:\n","                Xalpha[0,:] = X[i,:]\n","                Falpha      = fit[i,0]\n","                \n","            if fit[i,0] \u003c Fbeta and fit[i,0] \u003e Falpha:\n","                Xbeta[0,:]  = X[i,:]\n","                Fbeta       = fit[i,0]\n","                \n","            if fit[i,0] \u003c Fdelta and fit[i,0] \u003e Fbeta and fit[i,0] \u003e Falpha:\n","                Xdelta[0,:] = X[i,:]\n","                Fdelta      = fit[i,0]\n","\n","        curve[0,t] = Falpha.copy()\n","        print(\"Iteration:\", t + 1)\n","        print(\"Best (GWO + SSA (Random)):\", curve[0,t])\n","        t += 1\n","                \n","    # Best feature subset\n","    Gbin       = binary_conversion(Xalpha, thres, 1, dim) \n","    Gbin       = Gbin.reshape(dim)\n","    pos        = np.asarray(range(0, dim))    \n","    sel_index  = pos[Gbin == 1]\n","    num_feat   = len(sel_index)\n","    # Create dictionary\n","    gwo_data = {'sf': sel_index, 'c': curve, 'nf': num_feat}\n","    \n","    return gwo_data "]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"JX1PEKlVF5ko"},"outputs":[],"source":["# #####################################################################\n","# #######         WINE\n","# #####################################################################\n","\n","# column_headers = ['Type', 'Alcohol', 'Malic acid', 'Ash', 'Alcalinity of ash', 'Magnesium', 'Total phenols',\n","#                   'Flavanoids', 'Nonflavanoid phenols', 'Proanthocyanins', 'Color Intensity',\n","#                    'Hue', 'OD280/OD315 of diluted wines', 'Proline']\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/wine/wine.data', sep=\",\", header=None)\n","# # data = data.values\n","# data.dropna(inplace=True)\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 1:])\n","# target = np.asarray(dataArray[:, 0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"903021BERKby"},"outputs":[],"source":["# #####################################################################\n","# #######         BREAST CANCER\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.data', header=None)\n","# data.columns = ['Sample code', 'Clump Thickness', 'Uniformity of Cell Size', 'Uniformity of Cell Shape',\n","#                 'Marginal Adhesion', 'Single Epithelial Cell Size', 'Bare Nuclei', 'Bland Chromatin',\n","#                 'Normal Nucleoli', 'Mitoses','Class']\n","\n","# data = data.drop(['Sample code'],axis=1)\n","# # data = data.values\n","# print(data.shape[0])\n","# data = data.replace(\"?\",np.NaN)\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# data['Bare Nuclei'] = pd.to_numeric(data['Bare Nuclei'])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 1:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"uFO-xQ74ncSM"},"outputs":[],"source":["# #####################################################################\n","# #######         ZOO\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/zoo/zoo.data', header=None)\n","# # data = data.values\n","# data = data.loc[:, data.columns != 0]\n","# data = data.astype(float)\n","# print(data.shape[0])\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 0:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"l4dguS-ph9T4"},"outputs":[{"name":"stdout","output_type":"stream","text":["208\n","False\n","208\n","Data:           0       1       2       3       4       5       6       7       8   \\\n","0    0.0200  0.0371  0.0428  0.0207  0.0954  0.0986  0.1539  0.1601  0.3109   \n","1    0.0453  0.0523  0.0843  0.0689  0.1183  0.2583  0.2156  0.3481  0.3337   \n","2    0.0262  0.0582  0.1099  0.1083  0.0974  0.2280  0.2431  0.3771  0.5598   \n","3    0.0100  0.0171  0.0623  0.0205  0.0205  0.0368  0.1098  0.1276  0.0598   \n","4    0.0762  0.0666  0.0481  0.0394  0.0590  0.0649  0.1209  0.2467  0.3564   \n","..      ...     ...     ...     ...     ...     ...     ...     ...     ...   \n","203  0.0187  0.0346  0.0168  0.0177  0.0393  0.1630  0.2028  0.1694  0.2328   \n","204  0.0323  0.0101  0.0298  0.0564  0.0760  0.0958  0.0990  0.1018  0.1030   \n","205  0.0522  0.0437  0.0180  0.0292  0.0351  0.1171  0.1257  0.1178  0.1258   \n","206  0.0303  0.0353  0.0490  0.0608  0.0167  0.1354  0.1465  0.1123  0.1945   \n","207  0.0260  0.0363  0.0136  0.0272  0.0214  0.0338  0.0655  0.1400  0.1843   \n","\n","         9   ...      51      52      53      54      55      56      57  \\\n","0    0.2111  ...  0.0027  0.0065  0.0159  0.0072  0.0167  0.0180  0.0084   \n","1    0.2872  ...  0.0084  0.0089  0.0048  0.0094  0.0191  0.0140  0.0049   \n","2    0.6194  ...  0.0232  0.0166  0.0095  0.0180  0.0244  0.0316  0.0164   \n","3    0.1264  ...  0.0121  0.0036  0.0150  0.0085  0.0073  0.0050  0.0044   \n","4    0.4459  ...  0.0031  0.0054  0.0105  0.0110  0.0015  0.0072  0.0048   \n","..      ...  ...     ...     ...     ...     ...     ...     ...     ...   \n","203  0.2684  ...  0.0116  0.0098  0.0199  0.0033  0.0101  0.0065  0.0115   \n","204  0.2154  ...  0.0061  0.0093  0.0135  0.0063  0.0063  0.0034  0.0032   \n","205  0.2529  ...  0.0160  0.0029  0.0051  0.0062  0.0089  0.0140  0.0138   \n","206  0.2354  ...  0.0086  0.0046  0.0126  0.0036  0.0035  0.0034  0.0079   \n","207  0.2354  ...  0.0146  0.0129  0.0047  0.0039  0.0061  0.0040  0.0036   \n","\n","         58      59  60  \n","0    0.0090  0.0032   1  \n","1    0.0052  0.0044   1  \n","2    0.0095  0.0078   1  \n","3    0.0040  0.0117   1  \n","4    0.0107  0.0094   1  \n","..      ...     ...  ..  \n","203  0.0193  0.0157   2  \n","204  0.0062  0.0067   2  \n","205  0.0077  0.0031   2  \n","206  0.0036  0.0048   2  \n","207  0.0061  0.0115   2  \n","\n","[208 rows x 61 columns]\n"]}],"source":["# #####################################################################\n","# #######         SONAR\n","# #####################################################################\n","\n","# data = pd.read_csv('http://archive.ics.uci.edu/ml/machine-learning-databases/undocumented/connectionist-bench/sonar/sonar.all-data', header=None)\n","# # data = data.values\n","# mymap = {'R': 1, 'M': 2}\n","# data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","\n","# print(data.shape[0])\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 0:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"il9GXkFDjclR"},"outputs":[],"source":["# #####################################################################\n","# #######         LYMPHOGRAPHY\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/lymphography/lymphography.data', header=None)\n","# # data = data.values\n","\n","# print(data.shape[0])\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 1:])\n","# target = np.asarray(dataArray[:, 0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"wLTXml9EnCGr"},"outputs":[],"source":["#####################################################################\n","#######         CONGRESS\n","#####################################################################\n","\n","data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/voting-records/house-votes-84.data', header=None)\n","# data = data.values\n","mymap = {'n': 0, 'y': 1, 'democrat': 1, 'republican': 2}\n","data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","\n","print(data.shape[0])\n","data = data.replace(\"?\",np.NaN)\n","print(data.isnull().values.any())\n","data.dropna(inplace=True)\n","print(data.shape[0])\n","dataArray = data.to_numpy()\n","\n","print(\"Data: \", data)\n","\n","features  = np.asarray(dataArray[:, 1:])\n","target = np.asarray(dataArray[:, 0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"TiLc9BxJqZ01"},"outputs":[],"source":["# #####################################################################\n","# #######         IONOSPHERE\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/ionosphere/ionosphere.data', header=None)\n","# # data = data.values\n","# mymap = {'g': 1, 'b': 2}\n","# data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","\n","# print(data.shape[0])\n","# data = data.replace(\"?\",np.NaN)\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 0:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"s29v98J3wBtt"},"outputs":[],"source":["# #####################################################################\n","# #######         CHESS\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/chess/king-rook-vs-king-pawn/kr-vs-kp.data', header=None)\n","# # data = data.values\n","# mymap = {'f': 0., 't': 1., 'n': 0., 'w': 1., 'b': 2., 'l': 0., 'g': 1., 'won': 1., 'nowin': 2.}\n","# data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","\n","# print(data.shape[0])\n","# data = data.replace(\"?\",np.NaN)\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 0:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"UVTlCBdoAGEV"},"outputs":[],"source":["# #####################################################################\n","# #######         TIC-TAC-TOE\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/tic-tac-toe/tic-tac-toe.data', header=None)\n","# # data = data.values\n","# mymap = {'x': 1., 'o': 2., 'b': 3., 'positive': 1., 'negative': 2.}\n","# data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","\n","# print(data.shape[0])\n","# data = data.replace(\"?\",np.NaN)\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 0:-1])\n","# target = np.asarray(dataArray[:, -1])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"4DXBBeP1xJbW"},"outputs":[],"source":["# #####################################################################\n","# #######         WDBC\n","# #####################################################################\n","\n","# data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/wdbc.data', header=None)\n","# # data = data.values\n","# mymap = {'M': 1., 'B': 2.}\n","# data = data.applymap(lambda s: mymap.get(s) if s in mymap else s)\n","# data = data.loc[:, data.columns != 0]\n","\n","# print(data.shape[0])\n","# data = data.replace(\"?\",np.NaN)\n","# print(data.isnull().values.any())\n","# data.dropna(inplace=True)\n","# print(data.shape[0])\n","# dataArray = data.to_numpy()\n","\n","# print(\"Data: \", data)\n","\n","# features  = np.asarray(dataArray[:, 1:])\n","# target = np.asarray(dataArray[:, 0])"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"dPrVsZhAFTfQ"},"outputs":[{"name":"stdout","output_type":"stream","text":["Feature:  [[0.02   0.0371 0.0428 ... 0.0084 0.009  0.0032]\n"," [0.0453 0.0523 0.0843 ... 0.0049 0.0052 0.0044]\n"," [0.0262 0.0582 0.1099 ... 0.0164 0.0095 0.0078]\n"," ...\n"," [0.0522 0.0437 0.018  ... 0.0138 0.0077 0.0031]\n"," [0.0303 0.0353 0.049  ... 0.0079 0.0036 0.0048]\n"," [0.026  0.0363 0.0136 ... 0.0036 0.0061 0.0115]]\n"]}],"source":["print(\"Feature: \", features)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"XtX3qwmX9qVR"},"outputs":[{"name":"stdout","output_type":"stream","text":["Target:  [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.\n"," 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.\n"," 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.\n"," 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.\n"," 1. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n"," 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n"," 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n"," 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.\n"," 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2. 2.]\n"]}],"source":["print(\"Target: \", target)"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"8vLuNbkZ-XcK"},"outputs":[],"source":["num_runs = 20    # number of independent runs\n","k        = 5     # k-value in KNN\n","N        = 5     # number of particles\n","T        = 20    # maximum number of iterations\n","cv       = 10    # K-fold cross-validation\n","opts     = {'k':k, 'N':N, 'T':T, 'cv': cv}\n","dim      = features.shape[1]"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"3wRzIhMkAMZ6"},"outputs":[{"name":"stdout","output_type":"stream","text":["Run  1\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.07359782608695653\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.07359782608695653\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.05279347826086957\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.05279347826086957\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.05279347826086957\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.051364130434782614\n","SF [ 1  3  4  7  8  9 11]\n","Accuracy: 95.2536231884058\n","Feature Size: 7\n","Fitness 0.051364130434782614\n","--------------------------------------------------\n","Run  2\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.07288586956521739\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0649021739130435\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0649021739130435\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.0649021739130435\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.056918478260869564\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.056918478260869564\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.04355978260869565\n","SF [ 0  3  5  6  7 10 11 13]\n","Accuracy: 96.10507246376812\n","Feature Size: 8\n","Fitness 0.04355978260869565\n","--------------------------------------------------\n","Run  3\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.08031521739130436\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.07924456521739132\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.07924456521739132\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.06597282608695654\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.06597282608695654\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.05593478260869565\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.05530978260869565\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.05530978260869565\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.043380434782608696\n","SF [ 1  3  8  9 10 13 14 15]\n","Accuracy: 96.1231884057971\n","Feature Size: 8\n","Fitness 0.043380434782608696\n","--------------------------------------------------\n","Run  4\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0741358695652174\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0741358695652174\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.05736413043478262\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.051989130434782614\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.051989130434782614\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.051989130434782614\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03952173913043478\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03952173913043478\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03952173913043478\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.036201086956521744\n","SF [ 3  4  5  8  9 10 11 12 13 14]\n","Accuracy: 96.97463768115944\n","Feature Size: 10\n","Fitness 0.036201086956521744\n","--------------------------------------------------\n","Run  5\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.08444021739130435\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.07601086956521741\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.07601086956521741\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.07601086956521741\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.0702771739130435\n","SF [ 0  3  4  7  8 10 11 12 14 15]\n","Accuracy: 93.53260869565219\n","Feature Size: 10\n","Fitness 0.0702771739130435\n","--------------------------------------------------\n","Run  6\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.061668478260869575\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.051989130434782614\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.051989130434782614\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.051809782608695655\n","SF [ 0  3  4  9 10 11 12 14]\n","Accuracy: 95.27173913043478\n","Feature Size: 8\n","Fitness 0.051809782608695655\n","--------------------------------------------------\n","Run  7\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.07476086956521741\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.07476086956521741\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.07476086956521741\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.07476086956521741\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.07108152173913045\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.06309782608695652\n","SF [ 0  1  2  3  4  5  9 10 11 12 14 15]\n","Accuracy: 94.38405797101451\n","Feature Size: 12\n","Fitness 0.06309782608695652\n","--------------------------------------------------\n","Run  8\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.052168478260869566\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.052168478260869566\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.05154347826086956\n","SF [ 0  3  4  5  6 11 13]\n","Accuracy: 95.23550724637681\n","Feature Size: 7\n","Fitness 0.05154347826086956\n","--------------------------------------------------\n","Run  9\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0667771739130435\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.06490217391304348\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.038451086956521746\n","SF [ 3  4  8  9 12 14 15]\n","Accuracy: 96.55797101449275\n","Feature Size: 7\n","Fitness 0.038451086956521746\n","--------------------------------------------------\n","Run  10\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.03182608695652174\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03182608695652174\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03120108695652174\n","SF [2 3]\n","Accuracy: 96.97463768115944\n","Feature Size: 2\n","Fitness 0.03120108695652174\n","--------------------------------------------------\n","Run  11\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.05566847826086956\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0462554347826087\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0462554347826087\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03307608695652174\n","SF [ 2  3 10 13 15]\n","Accuracy: 96.97463768115944\n","Feature Size: 5\n","Fitness 0.03307608695652174\n","--------------------------------------------------\n","Run  12\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0731521739130435\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0731521739130435\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0731521739130435\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.061668478260869575\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.06122282608695653\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.057543478260869564\n","SF [ 0  2  3  4  5  6 10 11 14 15]\n","Accuracy: 94.81884057971016\n","Feature Size: 10\n","Fitness 0.057543478260869564\n","--------------------------------------------------\n","Run  13\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0513641304347826\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0513641304347826\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0513641304347826\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.0513641304347826\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.0513641304347826\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.04480978260869566\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.041130434782608714\n","SF [ 3  4  5  6  9 10 11 12 13 14 15]\n","Accuracy: 96.53985507246377\n","Feature Size: 11\n","Fitness 0.041130434782608714\n","--------------------------------------------------\n","Run  14\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.06983152173913044\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.06983152173913044\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.06983152173913044\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.06983152173913044\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.06983152173913044\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.061043478260869574\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.05736413043478262\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.05736413043478262\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.05736413043478262\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.05736413043478262\n","SF [ 1  2  3  5  6  8 10 11 12 13]\n","Accuracy: 94.83695652173914\n","Feature Size: 10\n","Fitness 0.05736413043478262\n","--------------------------------------------------\n","Run  15\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.06059782608695652\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.06059782608695652\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.06059782608695652\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.06059782608695652\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.0380054347826087\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.0380054347826087\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03495108695652173\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03495108695652173\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","SF [ 3 10 11 12 13 14]\n","Accuracy: 96.97463768115944\n","Feature Size: 6\n","Fitness 0.03370108695652174\n","--------------------------------------------------\n","Run  16\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0380054347826087\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0380054347826087\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0380054347826087\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03602173913043478\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03539673913043478\n","SF [ 3  4  5  7  9 10 12 13 14]\n","Accuracy: 96.99275362318842\n","Feature Size: 9\n","Fitness 0.03539673913043478\n","--------------------------------------------------\n","Run  17\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0696521739130435\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.058902173913043476\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.058902173913043476\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.058902173913043476\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","SF [ 3  4  5  8  9 15]\n","Accuracy: 96.97463768115944\n","Feature Size: 6\n","Fitness 0.03370108695652174\n","--------------------------------------------------\n","Run  18\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.0715271739130435\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.0715271739130435\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.0715271739130435\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.05816847826086958\n","SF [ 0  3  4  5  8 10 11 12 13 14 15]\n","Accuracy: 94.81884057971014\n","Feature Size: 11\n","Fitness 0.05816847826086958\n","--------------------------------------------------\n","Run  19\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.056472826086956536\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.056472826086956536\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.056472826086956536\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.056472826086956536\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.0468804347826087\n","SF [ 1  2  3  6  7 10 13]\n","Accuracy: 95.70652173913044\n","Feature Size: 7\n","Fitness 0.0468804347826087\n","--------------------------------------------------\n","Run  20\n","-----------------------------------\n","Iteration: 1\n","Best (GWO): 0.05691847826086958\n","Iteration: 2\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 3\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 4\n","Best (GWO + SSA (Random)): 0.05691847826086958\n","Iteration: 5\n","Best (GWO + SSA (Random)): 0.03800543478260869\n","Iteration: 6\n","Best (GWO + SSA (Random)): 0.03800543478260869\n","Iteration: 7\n","Best (GWO + SSA (Random)): 0.03800543478260869\n","Iteration: 8\n","Best (GWO + SSA (Random)): 0.03495108695652173\n","Iteration: 9\n","Best (GWO + SSA (Random)): 0.03495108695652173\n","Iteration: 10\n","Best (GWO + SSA (Random)): 0.03495108695652173\n","Iteration: 11\n","Best (GWO + SSA (Random)): 0.03432608695652174\n","Iteration: 12\n","Best (GWO + SSA (Random)): 0.03432608695652174\n","Iteration: 13\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 14\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 15\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 16\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 17\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 18\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 19\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","Iteration: 20\n","Best (GWO + SSA (Random)): 0.03370108695652174\n","SF [ 3  6  7 10 11 15]\n","Accuracy: 96.97463768115944\n","Feature Size: 6\n","Fitness 0.03370108695652174\n","--------------------------------------------------\n"]}],"source":["acc_arr          = []\n","feature_size_arr = []\n","time_arr         = []\n","fitness          = []\n","run_count        = 0\n","\n","while run_count \u003c num_runs:\n","  start_time = time.time()\n","  run_count += 1\n","  print(\"Run \", run_count)\n","  print(\"-----------------------------------\")\n","  fmdl = gwo_ssa_random(features, target, opts)\n","  sf   = fmdl['sf']\n","  \n","  if sf.size == 0:\n","    sf = np.arange(dim)\n","    \n","  print(\"SF\", sf)\n","\n","  kf = KFold(n_splits=cv, shuffle=True, random_state=2)\n","\n","  total_Acc = 0\n","\n","  for train_index, test_index in kf.split(features):\n","    X_train, X_test = features[train_index], features[test_index]\n","    y_train, y_test = target[train_index], target[test_index]\n","\n","    # Number of instances\n","    num_train = np.size(X_train, 0)\n","    num_test  = np.size(X_test, 0)\n","    \n","    # Define selected features\n","    xtrain = X_train[:, sf]\n","    ytrain = y_train.reshape(num_train)\n","    xtest  = X_test[:, sf]\n","    ytest  = y_test.reshape(num_test)\n","\n","    # Training\n","    knn = KNeighborsClassifier(n_neighbors=k)\n","    knn.fit(xtrain, ytrain)\n","\n","    # Prediction\n","    ypred = knn.predict(xtest)\n","    acc   = np.sum(ytest == ypred) / num_test\n","\n","    total_Acc = total_Acc + acc\n","\n","  time_arr.append(time.time() - start_time)\n","\n","  Accuracy = 100 * (total_Acc/cv)\n","  print(\"Accuracy:\", Accuracy)\n","  acc_arr.append(Accuracy)\n","\n","  num_feat = fmdl['nf']\n","  print(\"Feature Size:\", num_feat)\n","  feature_size_arr.append(num_feat)\n","\n","  fitt = fmdl['c'][0].min()\n","  print(\"Fitness\", fitt)\n","  fitness.append(fitt)\n","  print(\"--------------------------------------------------\")"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"background_save":true},"id":"lAE2cuZ-BIg1"},"outputs":[{"name":"stdout","output_type":"stream","text":["Average Accuracy:  95.90126811594205\n","Average fitness:  0.04557744565217392\n","Average number of features selected:  8.0\n","Average time taken:  2.10740932226181 seconds\n"]}],"source":["print(\"Average Accuracy: \", np.mean(acc_arr))\n","print(\"Average fitness: \", np.mean(fitness))\n","print(\"Average number of features selected: \", np.mean(feature_size_arr))\n","print(\"Average time taken: \", np.mean(time_arr), \"seconds\")"]}],"metadata":{"colab":{"collapsed_sections":[],"name":"FS - GWO+SSA (Random Switcher)","provenance":[{"file_id":"1G9njzMBoIfCPC577PHjS9jLUFBjLGDZ6","timestamp":1650042151380},{"file_id":"1Y9lONYGlYKNAKRu7Vtx_F4_kRLKwO85X","timestamp":1644342920042},{"file_id":"1sLs09JI33D9XUh-hgDzX6SVn7UXJNl70","timestamp":1644248848004}],"version":""},"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}